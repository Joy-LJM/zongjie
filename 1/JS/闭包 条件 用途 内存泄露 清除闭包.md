### 闭包形成条件
- 1、要有函数嵌套：外部函数内有内部函数

- 2、内部函数要保持对外部函数作用域的引用，也就是内部函数使用了外部函数定义的变量
  - 正常来讲函数执行完了之后就销毁，函数内的变量也就被销毁，
  - 如果一旦形成了闭包,保持了引用关系，浏览器对这种机制就不会去销毁；

- 3、内部函数要在声明的作用域之外访问：写法可以执行外部函数，然后return返回内部函数

- 4、闭包并不是单单内部函数，也不是单单外部函数；而是由该函数和其上层执行上下文共同构成

### 闭包特点和用途
- 闭包可以使外部函数定义的局部变量不会被销毁，一直保存在内存中
- 可以在外部访问函数的内部变量
- 通过闭包封装的私有变量可以被访问，也避免使用全局变量，防止全局变量污染
- 写模块：将模块的公有属性和方法暴露出来

### 闭包弊端和解决
- 由于局部变量常驻在内存，内存空间被长期占用，而不被释放，会造成内存泄漏

- 解决方法：把变量赋值为null => 在退出函数之前，将不使用的局部变量全部删除，赋值为null;


```
// 解决闭包内存泄露
window.onload = function(){
  var el = document.getElementById("id");
  var id = el.id;                                   
  el.onclick = function(){
      alert(id); 
  }
  el = null;    // 将闭包引用的外部函数中活动对象清除
}
```

```
// 闭包例子：outer函数执行，返回的就是就是inner这个函数，赋值给fn
function outer(x){
  var abc = 123
  return function inner(){
    console.lot(x)
    console.lot(abc)
  }
}
var fn = outer()
```

```
// 闭包写模块
var mymodule = (function(){ 
  var x = 123
  var age = 30
  function test(){
    return {
      x: x,
      age: age
    }
  }
})
```